/*
   YARA Rule Set
   Author: yarGen Rule Generator
   Date: 2022-07-06
   Identifier: mal
   Reference: https://github.com/Neo23x0/yarGen
*/

/* Rule Set ----------------------------------------------------------------- */

rule SodaPDF12Installer {
   meta:
      description = "mal - file SodaPDF12Installer.exe"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2022-07-06"
      hash1 = "985dee2634c12bf51e4b4112ac07922efd1a18287d0a94c8050ea2e7a47071b0"
   strings:
      $x1 = "SSL - Processing of the ClientKeyExchange handshake message failed in DHM / ECDH Read Public" fullword ascii
      $x2 = " unzip 1.01 Copyright 1998-2004 Gilles Vollant - http://www.winimage.com/zLibDll" fullword ascii
      $x3 = "ProcessRunner::SpawnAsUser::Execute" fullword ascii
      $x4 = "D:\\TemporaryBuilds\\installer_builder_1\\19\\s\\process-helper\\src\\ProcessHelper.cpp" fullword ascii
      $x5 = "SSL - Processing of the ServerKeyExchange handshake message failed" fullword ascii
      $x6 = "SSL - Processing of the ClientKeyExchange handshake message failed" fullword ascii
      $x7 = "msiexec.exe /quiet /norestart /uninstall %1% %2% %3%" fullword wide
      $x8 = "msiexec.exe /quiet /norestart /fp \"%1%\" %2% %3%" fullword wide
      $s9 = "SSL - Processing of the ClientKeyExchange handshake message failed in DHM / ECDH Calculate Secret" fullword ascii
      $s10 = "api-ms-win-core-synch-l1-2-0.dll" fullword wide /* reversed goodware string 'lld.0-2-1l-hcnys-eroc-niw-sm-ipa' */
      $s11 = "SSL - Processing of the NewSessionTicket handshake message failed" fullword ascii
      $s12 = " is committed to helping protect the privacy of users. This statement explains the data collection process and usage practices f" ascii
      $s13 = " is committed to helping protect the privacy of users. This statement explains the data collection process and usage practices f" ascii
      $s14 = "SSL - Processing of the compression / decompression failed" fullword ascii
      $s15 = "  \"redirector_link=https://paygw.sodapdf.com/redirect/\" \"params=lspid=LU170101SODA_DN&lang=it&partner=mb_pdf-reader&qti=a8f3e" wide
      $s16 = "PEM - Given private key password does not allow for correct decryption" fullword ascii
      $s17 = "PK - Given private key password does not allow for correct decryption" fullword ascii
      $s18 = "NET - Failed to get an IP address for the given hostname" fullword ascii
      $s19 = "PKCS12 - Given private key password does not allow for correct decryption" fullword ascii
      $s20 = "PKCS5 - Given private key password does not allow for correct decryption" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 52000KB and
      1 of ($x*) and 4 of them
}

