rule Common_potentially_malicious_function {

	meta:
		description = "signature for malware Soda_PDF12"
		author = "Vincenzo Riccardi, Michele Maresca, Marco Carlo Feliciano"
	
	strings:
	
		$SetWindowsHook = "SetWindowsHook" wide ascii
		$GetAsyncKeyState = "GetAsyncKeyState" wide ascii
		$GetForegroundWindow = "GetForegroundWindow" wide ascii
		$OpenProcessToken = "OpenProcessToken" wide ascii
		$LoadLibrary = "LoadLibrary" wide ascii
		$CreateFileMapping = "CreateFileMapping" wide ascii
		$MapFileOfView = "MapFileOfView" wide ascii
		$FindFirstFile = "FindFirstFile" wide ascii
		$FindNextFile = "FindNextFile" wide ascii
		$InternetOpen = "InternetOpen" wide ascii
		$HttpSendRequest = "HttpSendRequest" wide ascii
		$OpenSCManager = "OpenSCManager" wide ascii
		$CreateService = "CreateService" wide ascii
		$StartService = "StartService" wide ascii
		$RegOpenKey = "RegOpenKey" wide ascii
		$RegSetValue = "RegSetValue" wide ascii
		$RegCreateKey = "RegCreateKey" wide ascii
		$CreateMutex = "CreateMutex" wide ascii
		$CreateSemaphore = "CreateSemaphore" wide ascii
	
	condition:
		
		(9 of them)
}